\section{Advection schemes in MODFLOW6}

This example demonstrates the performance of different numerical advection schemes when solving the groundwater transport equation under pure advection conditions. The example provides a comparison of four advection schemes (upstream, central difference, TVD, and UTVD) across three different grid types (structured, triangular, and Voronoi) using three test functions with varying numerical challenges.

\subsection{Example description}

The problem solves the pure advection equation:

\begin{equation}
\frac{\partial \left(S_w \theta C\right)}{\partial t} = -\vec{\nabla} \cdot \left(\vec{q} \cdot C\right)
\label{eq:pureadvection}
\end{equation}

where $C$ is concentration, $S_w$ is water saturation, $\theta$ is porosity, and $\mathbf{q}$ is the specific discharge field. The problem is configured with no dispersion or diffusion terms, making it ideal for testing numerical scheme performance since an analytical solution exists.

The model domain consists of a 100 cm $\times$ 100 cm square with uniform flow at a 45° angle. The specific discharge field is $\vec{q} = (q_x, q_y) = (0.354, 0.354)$ cm/s, resulting from a hydraulic conductivity of 0.01 cm/s and a specific discharge magnitude of 0.5 cm/s. Prescribed concentrations are applied on the inflow boundaries (left and bottom edges), while CHD boundary conditions are used on the outflow boundaries which extract any outflowing concentration.

The spatial discretization uses three different grid types to test scheme performance across different mesh geometries:
\begin{itemize}
\item \textbf{Structured grid}: Regular 50 $\times$ 50 rectangular cells (2 cm $\times$ 2 cm)
\item \textbf{Triangular mesh}: Unstructured triangular elements with maximum area constraint
\item \textbf{Voronoi grid}: Voronoi polygon cells derived from triangular tessellation
\end{itemize}

The temporal discretization spans 300 seconds using adaptive time stepping with an initial time step of 5 seconds and a target Courant number of 0.7. This relatively high Courant number is chosen specifically to challenge the central difference scheme and demonstrate oscillatory behavior on discontinuous functions.

Four advection schemes are compared:
\begin{itemize}
\item \textbf{Upstream}: First-order accurate, stable but diffusive scheme
\item \textbf{Central difference}: Second-order accurate but prone to oscillations on discontinuities
\item \textbf{TVD}: Total Variation Diminishing scheme that handles sharp fronts well on structured grids
\item \textbf{UTVD}: Unstructured TVD scheme extending TVD capabilities to unstructured grids
\end{itemize}

Three test functions are used to probe different numerical challenges:
\begin{itemize}
\item \textbf{sin² wave}: Smooth function testing second-order accuracy
\item \textbf{Step wave}: Sharp transition testing boundedness properties
\item \textbf{Block wave}: Sharp rectangular discontinuity testing whether schemes can capture the original peak value of the analytical solution
\end{itemize}

The model parameters are summarized in table~\ref{tab:ex-gwt-adv-schemes-01}.

\input{../tables/ex-gwt-adv-schemes-01.tex}

\subsection{Example Results}

The example generates 39 total simulations: 3 flow models (one per grid type) and 36 transport models (3 grids $\times$ 4 schemes $\times$ 3 test functions). Results are presented in three complementary views to highlight different aspects of scheme performance.

\subsubsection{Flow Field}

Figure~\ref{fig:ex-gwt-adv-schemes-flow} shows the computed head fields for all three grid types. The results verify that the flow field produces the expected uniform gradient with a 45° angle across all grid geometries, providing the necessary foundation for the pure advection transport simulations. Head contours are parallel straight lines as expected for uniform flow, confirming the correct implementation of the boundary conditions and hydraulic properties.

\begin{StandardFigure}{
    Computed head fields for the three grid types used in the advection scheme comparison. \textit{Left}: Structured rectangular grid. \textit{Center}: Triangular mesh. \textit{Right}: Voronoi polygon grid. All grids produce the expected uniform head gradient at 45° angle.
}{fig:ex-gwt-adv-schemes-flow}{../figures/ex-gwt-adv-schemes-flow.png}
\end{StandardFigure}

\subsubsection{Concentration Field Results}

Figures~\ref{fig:ex-gwt-adv-schemes-sin2}, \ref{fig:ex-gwt-adv-schemes-step}, and \ref{fig:ex-gwt-adv-schemes-block} show the final concentration distributions for the three test functions across all scheme and grid combinations. These 2D concentration maps reveal the characteristic behavior of each numerical scheme, though the specific wave profiles are more clearly visualized in the cross-section analysis presented later:

\paragraph{Sin² wave results} (Figure~\ref{fig:ex-gwt-adv-schemes-sin2}) reveal important differences in scheme performance even for this smooth test function. While all schemes perform well on the structured grid, the central difference scheme becomes unstable on the triangular and Voronoi grids. On the structured grid, the central difference scheme is the least diffusive but exhibits undershoots resulting in negative concentrations due to the relatively high CFL number (0.7); lowering the CFL number eliminates this behavior. The UTVD scheme demonstrates robust performance across all grid types, maintaining both accuracy and stability.
\begin{StandardFigure}{
    Final concentration distributions for the sin² wave test function. Rows represent the four advection schemes (upstream, central difference, TVD, UTVD) and columns represent the three grid types (structured, triangular, Voronoi). All schemes perform well on this smooth test function.
}{fig:ex-gwt-adv-schemes-sin2}{../figures/ex-gwt-adv-schemes-sin2-wave-conc.png}
\end{StandardFigure}

\paragraph{Step wave results} (Figure~\ref{fig:ex-gwt-adv-schemes-step}) reveal more pronounced differences between schemes as the sharp transition challenges numerical stability. The central difference scheme no longer outperforms UTVD and displays clear oscillations that blow up on the triangular and Voronoi grids, demonstrating its unsuitability for unstructured meshes with discontinuous functions. The TVD and upstream schemes perform similarly with TVD slightly outperforming upstream in terms of accuracy. The UTVD scheme emerges as the least dissipative while maintaining stability across all grid types.
\begin{StandardFigure}{
    Final concentration distributions for the step wave test function. The central difference scheme begins to show oscillatory behavior near the sharp transition, while TVD and UTVD schemes maintain monotonic solutions.
}{fig:ex-gwt-adv-schemes-step}{../figures/ex-gwt-adv-schemes-step-wave-conc.png}
\end{StandardFigure}

\paragraph{Block wave results} (Figure~\ref{fig:ex-gwt-adv-schemes-block}) exhibit similar behavior to the step wave results, providing the most challenging test with sharp discontinuities. The TVD scheme outperforms upstream on the structured grid but performs similarly on the triangular and Voronoi grids. The central difference scheme shows oscillations on the structured grid and blows up on the other grids, with this behavior being related to the CFL number and reducing when the CFL number is lowered. The UTVD scheme works well on all grids and is the only stable scheme that actually comes close to the maximum value of the analytical solution, demonstrating its superior capability for handling sharp discontinuities across all grid types.
\begin{StandardFigure}{
    Final concentration distributions for the block wave test function. This challenging test with sharp discontinuities clearly demonstrates the oscillatory behavior of the central difference scheme and the superior performance of TVD/UTVD schemes in maintaining monotonic solutions.
}{fig:ex-gwt-adv-schemes-block}{../figures/ex-gwt-adv-schemes-block-wave-conc.png}
\end{StandardFigure}

\subsubsection{Cross-Section Analysis}

Figure~\ref{fig:ex-gwt-adv-schemes-conc-cross-section} presents concentration profiles along the centerline (y = 50 cm) for all test functions and grid types, comparing numerical solutions against the analytical solution. These 1D cross-sections provide quantitative assessment of scheme accuracy and enable detailed comparison of numerical behavior:

\textbf{Accuracy assessment}: The cross-sections reveal that UTVD schemes follow the analytical solution best for discontinuous functions, while maintaining computational stability. TVD schemes only slightly outperform the upstream scheme in terms of accuracy. The central difference scheme works well on smooth functions but its CFL condition is restricting, limiting its practical applicability.

\textbf{Oscillation identification}: Clear oscillations in the central difference scheme are visible as concentration values exceeding the physical bounds [0,1] or exhibiting spurious undershoot/overshoot behavior.

\textbf{Grid sensitivity}: The comparison across grid types demonstrates that UTVD maintains consistent performance regardless of grid geometry, while TVD may show some degradation on unstructured grids.

\textbf{Diffusion quantification}: The upstream scheme shows characteristic smearing of sharp features, providing a baseline for assessing the improvement offered by higher-order schemes.

\begin{StandardFigure}{
    Concentration cross-sections at y = 50 cm comparing numerical solutions (dashed lines with markers) against analytical solutions (solid lines) for all test functions and grid types. \textit{Rows}: Test functions (sin² wave, step wave, block wave). \textit{Columns}: Grid types (structured, triangular, Voronoi). The restricted y-axis range [-0.1, 1.1] helps visualize oscillations and overshoots.
}{fig:ex-gwt-adv-schemes-conc-cross-section}{../figures/ex-gwt-adv-schemes-conc-cross-section.png}
\end{StandardFigure}

\subsubsection{Key Findings}

This comprehensive comparison reveals several important findings for advection scheme selection in groundwater transport modeling:

\begin{enumerate}
\item \textbf{Grid-dependent performance}: The central difference scheme performs reasonably on structured grids but becomes unstable on triangular and Voronoi grids, particularly for discontinuous functions. This demonstrates the critical importance of considering grid type when selecting numerical schemes.

\item \textbf{CFL number sensitivity}: The central difference scheme's stability is highly sensitive to the CFL number. At CFL = 0.7, it exhibits undershoots leading to negative concentrations on smooth functions and oscillatory blowup on discontinuous functions. Reducing the CFL number mitigates these issues but at the cost of computational efficiency.

\item \textbf{UTVD scheme as overall best choice}: The UTVD scheme consistently outperforms all others across grid types and test functions. It maintains stability while being the least dissipative scheme, and is the only stable scheme that approaches the maximum values of analytical solutions for sharp discontinuities.

\item \textbf{TVD limitations on unstructured grids}: While TVD performs well on structured grids and outperforms upstream schemes for discontinuous functions, its advantage diminishes on unstructured grids where it performs similarly to the upstream scheme.

\item \textbf{Upstream scheme reliability}: The upstream scheme provides a stable baseline across all grid types and test functions, though with significant diffusion. It serves as a reliable fallback option when stability is paramount.

\item \textbf{Practical recommendations}: For unstructured mesh applications involving transport with potential sharp fronts, UTVD is the clear choice. For structured grids, TVD offers a good balance of accuracy and stability. The central difference scheme should be used with caution and requires careful CFL number selection, particularly on unstructured grids.
\end{enumerate}                 
